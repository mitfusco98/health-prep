Starting edit_appointment function for ID: 167
Request method: GET
Database error in edit_appointment: (psycopg2.OperationalError) SSL connection has been closed unexpectedly

[SQL: SELECT appointment.id AS appointment_id, appointment.patient_id AS appointment_patient_id, appointment.appointment_date AS appointment_appointment_date, appointment.appointment_time AS appointment_appointment_time, appointment.note AS appointment_note, appointment.status AS appointment_status, appointment.created_at AS appointment_created_at, appointment.updated_at AS appointment_updated_at 
FROM appointment 
WHERE appointment.id = %(pk_1)s]
[parameters: {'pk_1': 167}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
{"timestamp": "2025-06-05T23:45:49.201144Z", "level": "CRITICAL", "logger": "app", "message": "Unexpected Error [899447fc]:", "module": "app", "function": "handle_unexpected_error", "line": 379, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.203608Z", "level": "CRITICAL", "logger": "app", "message": "Unexpected Error [899447fc]:", "module": "app", "function": "handle_unexpected_error", "line": 379, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.204483Z", "level": "CRITICAL", "logger": "app", "message": "Error Type: OperationalError", "module": "app", "function": "handle_unexpected_error", "line": 380, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.204676Z", "level": "CRITICAL", "logger": "app", "message": "Error Type: OperationalError", "module": "app", "function": "handle_unexpected_error", "line": 380, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.204915Z", "level": "CRITICAL", "logger": "app", "message": "Error Message: (psycopg2.OperationalError) SSL connection has been closed unexpectedly\n\n[SQL: SELECT appointment.id AS appointment_id, appointment.patient_id AS appointment_patient_id, appointment.appointment_date AS appointment_appointment_date, appointment.appointment_time AS appointment_appointment_time, appointment.note AS appointment_note, appointment.status AS appointment_status, appointment.created_at AS appointment_created_at, appointment.updated_at AS appointment_updated_at \nFROM appointment \nWHERE appointment.id = %(pk_1)s]\n[parameters: {'pk_1': 167}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "app", "function": "handle_unexpected_error", "line": 381, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.205101Z", "level": "CRITICAL", "logger": "app", "message": "Error Message: (psycopg2.OperationalError) SSL connection has been closed unexpectedly\n\n[SQL: SELECT appointment.id AS appointment_id, appointment.patient_id AS appointment_patient_id, appointment.appointment_date AS appointment_appointment_date, appointment.appointment_time AS appointment_appointment_time, appointment.note AS appointment_note, appointment.status AS appointment_status, appointment.created_at AS appointment_created_at, appointment.updated_at AS appointment_updated_at \nFROM appointment \nWHERE appointment.id = %(pk_1)s]\n[parameters: {'pk_1': 167}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "app", "function": "handle_unexpected_error", "line": 381, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.205485Z", "level": "CRITICAL", "logger": "app", "message": "URL: https://b1b46abe-838d-464d-8410-80c925647698-00-1zl7ablirpohy.kirk.replit.dev/appointments/167/edit", "module": "app", "function": "handle_unexpected_error", "line": 382, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.205658Z", "level": "CRITICAL", "logger": "app", "message": "URL: https://b1b46abe-838d-464d-8410-80c925647698-00-1zl7ablirpohy.kirk.replit.dev/appointments/167/edit", "module": "app", "function": "handle_unexpected_error", "line": 382, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.205841Z", "level": "CRITICAL", "logger": "app", "message": "Method: GET", "module": "app", "function": "handle_unexpected_error", "line": 383, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.206032Z", "level": "CRITICAL", "logger": "app", "message": "Method: GET", "module": "app", "function": "handle_unexpected_error", "line": 383, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.206368Z", "level": "CRITICAL", "logger": "app", "message": "Remote Address: 10.82.3.123", "module": "app", "function": "handle_unexpected_error", "line": 384, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.206584Z", "level": "CRITICAL", "logger": "app", "message": "Remote Address: 10.82.3.123", "module": "app", "function": "handle_unexpected_error", "line": 384, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.226481Z", "level": "CRITICAL", "logger": "app", "message": "Stack Trace:\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.OperationalError: SSL connection has been closed unexpectedly\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n         ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/db_utils.py\", line 78, in wrapper\n    result = func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/comprehensive_logging.py\", line 70, in decorated_function\n    result = f(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/demo_routes.py\", line 2751, in edit_appointment\n    appointment = Appointment.query.get_or_404(appointment_id)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_sqlalchemy/query.py\", line 30, in get_or_404\n    rv = self.get(ident)\n         ^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in get\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/util/deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 3874, in _get_impl\n    return db_load_fn(\n           ^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) SSL connection has been closed unexpectedly\n\n[SQL: SELECT appointment.id AS appointment_id, appointment.patient_id AS appointment_patient_id, appointment.appointment_date AS appointment_appointment_date, appointment.appointment_time AS appointment_appointment_time, appointment.note AS appointment_note, appointment.status AS appointment_status, appointment.created_at AS appointment_created_at, appointment.updated_at AS appointment_updated_at \nFROM appointment \nWHERE appointment.id = %(pk_1)s]\n[parameters: {'pk_1': 167}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n", "module": "app", "function": "handle_unexpected_error", "line": 385, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:49.226875Z", "level": "CRITICAL", "logger": "app", "message": "Stack Trace:\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.OperationalError: SSL connection has been closed unexpectedly\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n         ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/db_utils.py\", line 78, in wrapper\n    result = func(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/comprehensive_logging.py\", line 70, in decorated_function\n    result = f(*args, **kwargs)\n             ^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/demo_routes.py\", line 2751, in edit_appointment\n    appointment = Appointment.query.get_or_404(appointment_id)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_sqlalchemy/query.py\", line 30, in get_or_404\n    rv = self.get(ident)\n         ^^^^^^^^^^^^^^^\n  File \"<string>\", line 2, in get\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/util/deprecations.py\", line 386, in warned\n    return fn(*args, **kwargs)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 1126, in get\n    return self._get_impl(ident, loading.load_on_pk_identity)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/query.py\", line 1135, in _get_impl\n    return self.session._get_impl(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 3874, in _get_impl\n    return db_load_fn(\n           ^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/loading.py\", line 694, in load_on_pk_identity\n    session.execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/context.py\", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1638, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1843, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1983, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2352, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1964, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 945, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (psycopg2.OperationalError) SSL connection has been closed unexpectedly\n\n[SQL: SELECT appointment.id AS appointment_id, appointment.patient_id AS appointment_patient_id, appointment.appointment_date AS appointment_appointment_date, appointment.appointment_time AS appointment_appointment_time, appointment.note AS appointment_note, appointment.status AS appointment_status, appointment.created_at AS appointment_created_at, appointment.updated_at AS appointment_updated_at \nFROM appointment \nWHERE appointment.id = %(pk_1)s]\n[parameters: {'pk_1': 167}]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n", "module": "app", "function": "handle_unexpected_error", "line": 385, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
{"timestamp": "2025-06-05T23:45:50.167571Z", "level": "WARNING", "logger": "api_access_middleware", "message": "API response: /appointments/167/edit -> 500", "module": "api_access_middleware", "function": "log_api_response_status", "line": 390, "thread": 139892086033984, "process": 3563, "request": {"method": "GET", "path": "/appointments/167/edit", "remote_addr": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "endpoint": "edit_appointment"}, "session": {"session_id": "W2aGuYKJpv5YjFkd5x5OEPrSscQAMiwQZSpLpifnfkE", "user_id": null, "username": null}, "security": {"ip_address": "10.82.3.123", "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Replit/1.0.14 Chrome/124.0.6367.119 Electron/30.0.3 Safari/537.36", "timestamp": 1749167149.1935024}}
